"use strict";const e=require("../../common/vendor.js"),l=require("../../services/profile.js");require("../../stores/index.js");const a=require("../../stores/modules/member.js");require("../../utils/http.js");const o=e.defineComponent({__name:"profile",setup(o){const{safeAreaInsets:i}=e.index.getSystemInfoSync(),n=e.ref({});e.onLoad((()=>{(async()=>{const e=await l.getMemberProfileAPI();n.value=e.result})()}));const t=a.useMemberStore(),u=()=>{e.index.chooseMedia({count:1,mediaType:["image"],success:l=>{const{tempFilePath:a}=l.tempFiles[0];e.index.uploadFile({url:"/member/profile/avatar",name:"file",filePath:a,success:l=>{if(200===l.statusCode){console.log("成功成功");const a=JSON.parse(l.data).result.avatar;n.value.avatar=a,t.profile.avatar=a,e.index.showToast({title:"更改头像成功",icon:"success"}),console.log("头像",t.profile.avatar)}else e.index.showToast({title:"出错了",icon:"error"})}})}})},r=async()=>{var a;const{nickname:o,gender:i,birthday:u}=n.value;await l.putMemberProfileAPI({nickname:o,gender:i,birthday:u,provinceCode:v[0],cityCode:v[1],countryCode:v[2]}),t.profile.nickname=null==(a=n.value)?void 0:a.nickname,e.index.showToast({title:"成功修改",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),1e3)},s=e=>{n.value.gender=e.detail.value},d=e=>{n.value.birthday=e.detail.value};let v=["","",""];const c=e=>{n.value.fullLocation=e.detail.value.join(" "),v=e.detail.code};return(l,a)=>{var o,t,v,m,f,p,h,y,b,g,x,k,j,w,P;return e.e({a:(null==(o=e.unref(i))?void 0:o.top)+"px",b:null==(t=n.value)?void 0:t.avatar,c:e.o(u),d:e.t(null==(v=n.value)?void 0:v.account),e:n.value.nickname,f:e.o((e=>n.value.nickname=e.detail.value)),g:"男"===(null==(m=n.value)?void 0:m.gender),h:"女"===(null==(f=n.value)?void 0:f.gender),i:e.o(s),j:null==(p=n.value)?void 0:p.birthday},(null==(h=n.value)?void 0:h.birthday)?{k:e.t(null==(y=n.value)?void 0:y.birthday)}:{},{l:e.o(d),m:new Date,n:null==(b=n.value)?void 0:b.birthday,o:null==(g=n.value)?void 0:g.fullLocation},(null==(x=n.value)?void 0:x.fullLocation)?{p:e.t(null==(k=n.value)?void 0:k.fullLocation)}:{},{q:e.o(c),r:null==(w=null==(j=n.value)?void 0:j.fullLocation)?void 0:w.split(" "),s:null==(P=n.value)?void 0:P.profession,t:e.o(r)})}}});wx.createPage(o);
