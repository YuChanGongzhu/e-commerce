"use strict";const e=require("../../common/vendor.js"),r=require("../../composables/index.js"),t=require("../../services/order.js"),a=require("../../services/contants.js"),o=require("../../services/pay.js");if(require("../../utils/http.js"),require("../../stores/index.js"),require("../../stores/modules/member.js"),!Array){(e.resolveComponent("uni-countdown")+e.resolveComponent("XtxGuess")+e.resolveComponent("PageSkeleton")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-countdown/uni-countdown.js")+(()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-popup/uni-popup.js"))();const u=e.defineComponent({__name:"detail",props:{id:null},setup(u){const n=u,{safeAreaInsets:l}=e.index.getSystemInfoSync(),{guessRef:i,onScrolltolower:d}=r.useGuessList(),s=e.ref(),c=e.ref(["商品无货","不想要了","商品信息填错了","地址信息填写错误","商品降价","其它"]),f=e.ref(""),v=getCurrentPages(),S=v.at(-1);e.onReady((()=>{S.animate(".navbar",[{backgroundColor:"transparent"},{backgroundColor:"#f8f8f8"}],1e3,{scrollSource:"#myScroller",timeRange:1e3,startScrollOffset:0,endScrollOffset:50}),S.animate(".navbar .title",[{color:"transparent"},{color:"#000"}],1e3,{scrollSource:"#myScroller",timeRange:1e3,startScrollOffset:0,endScrollOffset:50}),S.animate(".navbar .back",[{color:"#fff"},{color:"#000"}],1e3,{scrollSource:"#myScroller",timeRange:1e3,startScrollOffset:0,endScrollOffset:50})}));const p=e.ref();e.onLoad((()=>{(async()=>{const e=await t.getMemberOrderByIdAPI(n.id);p.value=e.result,[a.OrderState.DaiShouHuo,a.OrderState.DaiPingJia,a.OrderState.YiWanCheng].includes(p.value.orderState)&&g()})()}));const m=e.ref(),g=async()=>{const e=await t.getMemberOrderLogisticsByIdAPI(n.id);m.value=e.result.list},O=()=>{p.value.orderState=a.OrderState.YiQuXiao},y=async()=>{{const r=await o.getPayWxPayMiniPayAPI({orderId:n.id});e.wx$1.requestPayment(r.result)}e.index.redirectTo({url:`/pagesOrder/payment/payment?id=${n.id}`})},b=async()=>{},x=()=>{e.index.showModal({title:"为保障您的权益，请在收到商品后再点击确认",success:async e=>{if(e.confirm){const e=await t.putMemberOrderReceiptByIdAPI(n.id);p.value=e.result}}})},P=()=>{e.index.showModal({title:"是否删除订单",success:async r=>{r.confirm&&(await t.deleteMemberOrderAPI({ids:[n.id]}),e.index.redirectTo({url:"/pagesOrders/list/list"}))}})};return(r,t)=>{var o,u,S,g,D;return e.e({a:e.unref(v).length>1},(e.unref(v).length,{}),{b:(null==(o=e.unref(l))?void 0:o.top)+"px",c:p.value},p.value?e.e({d:(null==(u=p.value)?void 0:u.orderState)===e.unref(a.OrderState).DaiFuKuan},(null==(S=p.value)?void 0:S.orderState)===e.unref(a.OrderState).DaiFuKuan?{e:e.t(p.value.payMoney),f:e.o(O),g:e.p({second:p.value.countdown,color:"#fff","splitor-color":"#fff","show-day":!1,"show-colon":!1}),h:e.o(y)}:e.e({i:e.t(e.unref(a.orderStateList)[p.value.orderState].text),j:`/pagesOrder/create/create?orderId=${n.id}`,k:e.unref(false)&&p.value.orderState===e.unref(a.OrderState).DaiFaHuo},e.unref(false)&&p.value.orderState===e.unref(a.OrderState).DaiFaHuo?{l:e.o(b)}:{},{m:p.value.orderState===e.unref(a.OrderState).DaiShouHuo},p.value.orderState===e.unref(a.OrderState).DaiShouHuo?{n:e.o(x)}:{}),{o:e.unref(l).top+20+"px",p:e.f(m.value,((r,t,a)=>({a:e.t(r.text),b:e.t(r.time),c:r.id}))),q:e.t(p.value.receiverContact),r:e.t(p.value.receiverMobile),s:e.t(p.value.receiverAddress),t:e.f(p.value.skus,((r,t,a)=>({a:r.image,b:e.t(r.name),c:e.t(r.attrsText),d:e.t(r.curPrice),e:e.t(r.quantity),f:r.spuId,g:`/pages/goods/goods?id=${r.spuId}`})))},{},{v:e.t(p.value.totalMoney),w:e.t(p.value.postFee),x:e.t(p.value.payMoney),y:e.t(n.id),z:e.o((r=>{return t=n.id,void e.index.setClipboardData({data:t});var t})),A:e.t(p.value.createTime),B:e.sr(i,"4555165b-1",{k:"guessRef"}),C:(null==(g=e.unref(l))?void 0:g.bottom)+"px",D:p.value.orderState===e.unref(a.OrderState).DaiFuKuan},p.value.orderState===e.unref(a.OrderState).DaiFuKuan?{E:e.o((e=>{var r,t;return null==(t=null==(r=s.value)?void 0:r.open)?void 0:t.call(r)}))}:e.e({F:`/pagesOrder/create/create?orderId=${n.id}`,G:p.value.orderState===e.unref(a.OrderState).DaiShouHuo},p.value.orderState===e.unref(a.OrderState).DaiShouHuo?{H:e.o(x)}:{},{I:p.value.orderState===e.unref(a.OrderState).DaiPingJia},(p.value.orderState,e.unref(a.OrderState).DaiPingJia,{}),{J:p.value.orderState>=e.unref(a.OrderState).DaiPingJia},p.value.orderState>=e.unref(a.OrderState).DaiPingJia?{K:e.o(P)}:{}),{L:(null==(D=e.unref(l))?void 0:D.bottom)+"px"}):{},{M:e.o(((...r)=>e.unref(d)&&e.unref(d)(...r))),N:e.f(c.value,((r,t,a)=>({a:e.t(r),b:r===f.value?1:"",c:r,d:e.o((e=>f.value=r),r)}))),O:e.o((e=>{var r,t;return null==(t=null==(r=s.value)?void 0:r.close)?void 0:t.call(r)})),P:e.sr(s,"4555165b-3",{k:"popup"}),Q:e.p({type:"bottom","background-color":"#fff"})})}}});wx.createPage(u);
