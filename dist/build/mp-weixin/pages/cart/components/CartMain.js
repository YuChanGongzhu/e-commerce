"use strict";const e=require("../../../common/vendor.js");require("../../../stores/index.js");const t=require("../../../services/cart.js"),n=require("../../../stores/modules/member.js");if(require("../../../utils/http.js"),!Array){(e.resolveComponent("vk-data-input-number-box")+e.resolveComponent("uni-swipe-action-item")+e.resolveComponent("uni-swipe-action"))()}Math||((()=>"../../../components/vk-data-input-number-box/vk-data-input-number-box.js")+(()=>"../../../node-modules/@dcloudio/uni-ui/lib/uni-swipe-action-item/uni-swipe-action-item.js")+(()=>"../../../node-modules/@dcloudio/uni-ui/lib/uni-swipe-action/uni-swipe-action.js")+u)();const u=()=>"../../../components/XtxGuess.js",o=e.defineComponent({__name:"CartMain",setup(u){const o=n.useMemberStore(),r=e.ref(),s=async()=>{const e=await t.getMemberCartAPI();r.value=e.result};e.onShow((()=>{o.profile&&s()}));const i=e=>{t.putMemberCartBySkuIdAPI(e.index,{count:e.value})},a=e.computed((()=>{var e;return(null==(e=r.value)?void 0:e.length)&&r.value.every((e=>e.selected))})),c=()=>{var e;const n=!a.value;null==(e=r.value)||e.forEach((e=>{e.selected=n})),t.putMemberCartSelectedAPI({selected:n})},l=e.computed((()=>{var e;return null==(e=r.value)?void 0:e.filter((e=>e.selected))})),d=e.computed((()=>{var e;return null==(e=l.value)?void 0:e.reduce(((e,t)=>e+t.count),0)})),m=e.computed((()=>{var e;return null==(e=l.value)?void 0:e.reduce(((e,t)=>e+t.count*t.nowPrice),0)})),v=()=>{if(0===d.value)return e.index.showToast({title:"未选中商品",icon:"none"});e.index.navigateTo({url:"/pagesOrder/create/create"})};return(n,u)=>{var l,p;return e.e({a:e.unref(o).profile},e.unref(o).profile?e.e({b:null==(l=r.value)?void 0:l.length},(null==(p=r.value)?void 0:p.length)?{c:e.f(r.value,((n,u,o)=>({a:e.o((e=>(e=>{e.selected=!e.selected,t.putMemberCartBySkuIdAPI(e.skuId,{selected:e.selected})})(n)),n.skuId),b:n.selected?1:"",c:n.picture,d:e.t(n.name),e:e.t(n.attrsText),f:e.t(n.nowPrice),g:`/pages/goods/goods?id=${n.id}`,h:e.o(i,n.skuId),i:"031998c2-2-"+o+",031998c2-1-"+o,j:e.o((e=>n.count=e),n.skuId),k:e.p({min:1,max:n.stock,index:n.skuId,modelValue:n.count}),l:e.o((u=>(async n=>{e.index.showModal({title:"是否删除",success:async({confirm:e,cancel:u})=>{e&&(await t.deleteMemberCartAPI({ids:[n]}),s())}})})(n.skuId)),n.skuId),m:n.skuId,n:"031998c2-1-"+o+",031998c2-0"})))}:{},{d:e.o(c),e:e.unref(a)?1:"",f:e.t(e.unref(m)),g:e.t(e.unref(d)),h:e.o(v),i:0===e.unref(d)?1:""}):{},{j:e.sr("guessRef","031998c2-3")})}}});wx.createComponent(o);
