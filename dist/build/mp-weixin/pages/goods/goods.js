"use strict";const e=require("../../common/vendor.js"),o=require("../../services/goods.js"),u=require("../../services/cart.js");if(require("../../utils/http.js"),require("../../stores/index.js"),require("../../stores/modules/member.js"),!Array){(e.resolveComponent("vk-data-goods-sku-popup")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../components/vk-data-goods-sku-popup/vk-data-goods-sku-popup.js")+r+s+(()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-popup/uni-popup.js"))();const r=()=>"./components/AdressPanel.js",s=()=>"./components/SevicePanel.js",a=e.defineComponent({__name:"goods",props:{id:null},setup(r){const s=r,{safeAreaInsets:a}=e.index.getSystemInfoSync(),l=e.ref();e.onLoad((()=>{(async()=>{const e=await o.getGoodsByIdAPI(s.id);l.value=e.result,p.value={_id:e.result.id,name:e.result.name,goods_thumb:e.result.mainPictures[0],spec_list:e.result.specs.map((e=>({name:e.name,list:e.values}))),sku_list:e.result.skus.map((o=>({_id:o.id,goods_id:e.result.id,goods_name:e.result.name,image:o.picture,price:100*o.price,stock:o.inventory,sku_name_arr:o.specs.map((e=>e.valueName))})))}})()}));const t=e.ref(0),n=e=>{t.value=e.detail.current},i=e.ref(),d=e.ref(),v=e=>{var o;d.value=e,null==(o=i.value)||o.open()},c=e.ref(!1),p=e.ref({}),m=e.ref(1),f=e=>{m.value=e,c.value=!0},g=e.ref(),k=e.computed((()=>{var e,o;return(null==(o=null==(e=g.value)?void 0:e.selectArr)?void 0:o.join(" ").trim())||"请选择商品规格"})),b=async o=>{await u.postMemberCartAPI({skuId:o._id,count:o.buy_num}),e.index.showToast({title:"加入购物车成功"}),c.value=!1},_=o=>{e.index.navigateTo({url:`/pagesOrder/create/create?skuId=${o._id}&count=${o.buy_num}`}),c.value=!1};return(o,u)=>{var r,s,y,j,A,P,x,B;return e.e({a:e.sr(g,"238d6cf1-0",{k:"skuPopupRef"}),b:e.o(b),c:e.o(_),d:e.o((e=>c.value=e)),e:e.p({localdata:p.value,mode:m.value,"add-cart-background-color":"#FFA868","buy-now-background-color":"#27BA9B","actived-style":{color:"#27BA9B",borderColor:"#27BA9B",backgroundColor:"#E9F8F5"},modelValue:c.value}),f:e.f(l.value.mainPictures,((o,u,r)=>({a:e.o((u=>{return r=o,void e.index.previewImage({current:r,urls:l.value.mainPictures});var r}),o),b:o,c:o}))),g:e.o(n),h:e.t(t.value+1),i:e.t(null==(r=l.value)?void 0:r.mainPictures.length),j:e.t(null==(s=l.value)?void 0:s.price),k:e.t(null==(y=l.value)?void 0:y.name),l:e.t(null==(j=l.value)?void 0:j.desc),m:e.t(e.unref(k)),n:e.o((e=>f(1))),o:e.o((e=>v("address"))),p:e.o((e=>v("service"))),q:e.f(null==(A=l.value)?void 0:A.details.properties,((o,u,r)=>({a:e.t(o.name),b:e.t(o.value)}))),r:e.f(null==(P=l.value)?void 0:P.details.pictures,((e,o,u)=>({a:e}))),s:e.f(null==(x=l.value)?void 0:x.similarProducts,((o,u,r)=>({a:o.picture,b:e.t(o.name),c:e.t(o.price),d:o.id,e:`/pages/goods/goods?id=${o.id}`}))),t:e.o((e=>f(2))),v:e.o((e=>f(3))),w:(null==(B=e.unref(a))?void 0:B.bottom)+"px",x:"address"===d.value},"address"===d.value?{y:e.o((e=>{var o;return null==(o=i.value)?void 0:o.close()}))}:{},{z:"service"===d.value},"service"===d.value?{A:e.o((e=>{var o;return null==(o=i.value)?void 0:o.close()}))}:{},{B:e.sr(i,"238d6cf1-1",{k:"popup"}),C:e.p({type:"bottom","background-color":"#fff"})})}}});wx.createPage(a);
