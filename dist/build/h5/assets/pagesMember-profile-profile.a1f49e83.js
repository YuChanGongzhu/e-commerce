import{d as a,l as e,r as l,q as t,v as s,o as u,c as r,w as o,f as n,a as c,m as d,p as i,u as v,t as f,R as m,z as p,I as _,h,i as b,g as k,k as y,J as g,T as C,U as x,V as T,W as w,D as j}from"./index-bf3db433.js";import{h as L}from"./http.d330a529.js";import{_ as V}from"./_plugin-vue_export-helper.1b428a4d.js";const F=V(a({__name:"profile",setup(a){const{safeAreaInsets:V}=e(),F=l({}),I=async()=>{const a=await L({method:"GET",url:"/member/profile"});F.value=a.result};t((()=>{I()}));const P=s(),U=()=>{uni.chooseMedia({count:1,mediaType:["image"],success:a=>{const{tempFilePath:e}=a.tempFiles[0];m({url:"/member/profile/avatar",name:"file",filePath:e,success:a=>{if(200===a.statusCode){console.log("成功成功");const e=JSON.parse(a.data).result.avatar;F.value.avatar=e,P.profile.avatar=e,p({title:"更改头像成功",icon:"success"}),console.log("头像",P.profile.avatar)}else p({title:"出错了",icon:"error"})}})}})},D=async()=>{var a;const{nickname:e,gender:l,birthday:t}=F.value;var s;await(s={nickname:e,gender:l,birthday:t,provinceCode:z[0],cityCode:z[1],countryCode:z[2]},L({method:"PUT",url:"/member/profile",data:s})),P.profile.nickname=null==(a=F.value)?void 0:a.nickname,p({title:"成功修改",icon:"success"}),setTimeout((()=>{_()}),1e3)},J=a=>{F.value.gender=a.detail.value},q=a=>{F.value.birthday=a.detail.value};let z=["","",""];const A=a=>{F.value.fullLocation=a.detail.value.join(" "),z=a.detail.code};return(a,e)=>{const l=h,t=b,s=k,m=y,p=g,_=C,L=x,I=T,P=w,z=j;return u(),r(t,{class:"viewport"},{default:o((()=>{var a;return[n(" 导航栏 "),c(t,{class:"navbar",style:i({paddingTop:(null==(a=v(V))?void 0:a.top)+"px"})},{default:o((()=>[c(l,{"open-type":"navigateBack",class:"back icon-left","hover-class":"none"}),c(t,{class:"title"},{default:o((()=>[d("个人信息")])),_:1})])),_:1},8,["style"]),n(" 头像 "),c(t,{class:"avatar"},{default:o((()=>[c(t,{onClick:U,class:"avatar-content"},{default:o((()=>{var a;return[c(s,{class:"image",src:null==(a=F.value)?void 0:a.avatar,mode:"aspectFill"},null,8,["src"]),c(m,{class:"text"},{default:o((()=>[d("点击修改头像")])),_:1})]})),_:1})])),_:1}),n(" 表单 "),c(t,{class:"form"},{default:o((()=>[n(" 表单内容 "),c(t,{class:"form-content"},{default:o((()=>[c(t,{class:"form-item"},{default:o((()=>[c(m,{class:"label"},{default:o((()=>[d("账号")])),_:1}),c(m,{class:"account"},{default:o((()=>{var a;return[d(f(null==(a=F.value)?void 0:a.account),1)]})),_:1})])),_:1}),c(t,{class:"form-item"},{default:o((()=>[c(m,{class:"label"},{default:o((()=>[d("昵称")])),_:1}),c(p,{class:"input",type:"text",placeholder:"请填写昵称",modelValue:F.value.nickname,"onUpdate:modelValue":e[0]||(e[0]=a=>F.value.nickname=a)},null,8,["modelValue"])])),_:1}),c(t,{class:"form-item"},{default:o((()=>[c(m,{class:"label"},{default:o((()=>[d("性别")])),_:1}),c(I,{onChange:J},{default:o((()=>[c(L,{class:"radio"},{default:o((()=>{var a;return[c(_,{value:"男",color:"#27ba9b",checked:"男"===(null==(a=F.value)?void 0:a.gender)},null,8,["checked"]),d(" 男 ")]})),_:1}),c(L,{class:"radio"},{default:o((()=>{var a;return[c(_,{value:"女",color:"#27ba9b",checked:"女"===(null==(a=F.value)?void 0:a.gender)},null,8,["checked"]),d(" 女 ")]})),_:1})])),_:1})])),_:1}),c(t,{class:"form-item"},{default:o((()=>{var a;return[c(m,{class:"label"},{default:o((()=>[d("生日")])),_:1}),c(P,{onChange:q,class:"picker",mode:"date",start:"1900-01-01",end:new Date,value:null==(a=F.value)?void 0:a.birthday},{default:o((()=>{var a;return[(null==(a=F.value)?void 0:a.birthday)?(u(),r(t,{key:0},{default:o((()=>{var a;return[d(f(null==(a=F.value)?void 0:a.birthday),1)]})),_:1})):(u(),r(t,{key:1,class:"placeholder"},{default:o((()=>[d("请选择日期")])),_:1}))]})),_:1},8,["end","value"])]})),_:1}),c(t,{class:"form-item"},{default:o((()=>{var a,e;return[c(m,{class:"label"},{default:o((()=>[d("城市")])),_:1}),c(P,{onChange:A,class:"picker",mode:"region",value:null==(e=null==(a=F.value)?void 0:a.fullLocation)?void 0:e.split(" ")},{default:o((()=>{var a;return[(null==(a=F.value)?void 0:a.fullLocation)?(u(),r(t,{key:0},{default:o((()=>{var a;return[d(f(null==(a=F.value)?void 0:a.fullLocation),1)]})),_:1})):(u(),r(t,{key:1,class:"placeholder"},{default:o((()=>[d("请选择城市")])),_:1}))]})),_:1},8,["value"])]})),_:1}),c(t,{class:"form-item"},{default:o((()=>{var a;return[c(m,{class:"label"},{default:o((()=>[d("职业")])),_:1}),c(p,{class:"input",type:"text",placeholder:"请填写职业",value:null==(a=F.value)?void 0:a.profession},null,8,["value"])]})),_:1})])),_:1}),n(" 提交按钮 "),c(z,{class:"form-button",onClick:D},{default:o((()=>[d("保 存")])),_:1})])),_:1})]})),_:1})}}}),[["__scopeId","data-v-a6ea6000"]]);export{F as default};
