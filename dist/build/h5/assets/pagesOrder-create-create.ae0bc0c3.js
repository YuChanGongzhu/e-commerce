import{d as s,l as e,r as a,y as l,q as t,o as u,b as r,a as d,w as o,f as c,u as n,c as i,m as p,t as m,F as f,e as v,n as _,p as y,z as g,$ as x,i as b,k,h,W as I,J as j,s as w,g as F}from"./index-bf3db433.js";import{g as P,a as T,p as A}from"./order.61ce54ab.js";import{u as C}from"./address.db0dc13a.js";import{_ as M}from"./_plugin-vue_export-helper.1b428a4d.js";import"./http.d330a529.js";const V=M(s({__name:"create",props:{skuId:null,count:null},setup(s){const M=s,{safeAreaInsets:V}=e(),$=a(""),q=a([{type:1,text:"时间不限 (周一至周日)"},{type:2,text:"工作日送 (周一至周五)"},{type:3,text:"周末配送 (周六至周日)"}]),z=a(0),B=l((()=>q.value[z.value])),D=s=>{z.value=s.detail.value},J=a();t((()=>{(async()=>{if(M.count&&M.skuId){const s=await P({skuId:M.skuId,count:M.count});J.value=s.result}else{const s=await T();J.value=s.result}})()}));const L=l((()=>{var s;return C().selectedAddress||(null==(s=J.value)?void 0:s.userAddresses.find((s=>s.isDefault)))})),N=async()=>{var s;if(null==(s=L.value)?void 0:s.id){const s=await A({addressId:L.value.id,buyerMessage:$.value,deliveryTimeType:B.value.type,goods:J.value.goods.map((s=>({count:Number(s.count),skuId:s.skuId}))),payChannel:2,payType:1});x({url:`/pagesOrder/detail/detail?id=${s.result.id}`})}else g({title:"请选择收货地址",icon:"none"})};return(s,e)=>{var a;const l=b,t=k,g=h,x=F,P=I,T=j,A=w;return u(),r(f,null,[d(A,{"scroll-y":"",class:"viewport"},{default:o((()=>[c(" 收货地址 "),n(L)?(u(),i(g,{key:0,class:"shipment","hover-class":"none",url:"/pagesMember/address/address?from=order"},{default:o((()=>[d(l,{class:"user"},{default:o((()=>{var s;return[p(m(null==(s=n(L))?void 0:s.receiver)+" "+m(n(L).contact),1)]})),_:1}),d(l,{class:"address"},{default:o((()=>{var s;return[p(m(n(L).fullLocation)+" "+m(null==(s=n(L))?void 0:s.address),1)]})),_:1}),d(t,{class:"icon icon-right"})])),_:1})):(u(),i(g,{key:1,class:"shipment","hover-class":"none",url:"/pagesMember/address/address?from=order"},{default:o((()=>[d(l,{class:"address"},{default:o((()=>[p(" 请选择收货地址 ")])),_:1}),d(t,{class:"icon icon-right"})])),_:1})),c(" 商品信息 "),d(l,{class:"goods"},{default:o((()=>{var s;return[(u(!0),r(f,null,v(null==(s=J.value)?void 0:s.goods,(s=>(u(),i(g,{key:s.skuId,url:"/pages/goods/goods?id=1",class:"item","hover-class":"none"},{default:o((()=>[d(x,{class:"picture",src:s.picture},null,8,["src"]),d(l,{class:"meta"},{default:o((()=>[d(l,{class:"name ellipsis"},{default:o((()=>[p(m(s.name),1)])),_:2},1024),d(l,{class:"attrs"},{default:o((()=>[p(m(s.attrsText),1)])),_:2},1024),d(l,{class:"prices"},{default:o((()=>[d(l,{class:"pay-price symbol"},{default:o((()=>[p(m(s.payPrice),1)])),_:2},1024),d(l,{class:"price symbol"},{default:o((()=>[p(m(s.price),1)])),_:2},1024)])),_:2},1024),d(l,{class:"count"},{default:o((()=>[p("x"+m(s.count),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))]})),_:1}),c(" 配送及支付方式 "),d(l,{class:"related"},{default:o((()=>[d(l,{class:"item"},{default:o((()=>[d(t,{class:"text"},{default:o((()=>[p("配送时间")])),_:1}),d(P,{range:q.value,"range-key":"text",onChange:D},{default:o((()=>[d(l,{class:"icon-fonts picker"},{default:o((()=>[p(m(n(B).text),1)])),_:1})])),_:1},8,["range"])])),_:1}),d(l,{class:"item"},{default:o((()=>[d(t,{class:"text"},{default:o((()=>[p("订单备注")])),_:1}),d(T,{class:"input","cursor-spacing":30,placeholder:"选题，建议留言前先与商家沟通确认",modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=s=>$.value=s)},null,8,["modelValue"])])),_:1})])),_:1}),c(" 支付金额 "),d(l,{class:"settlement"},{default:o((()=>[d(l,{class:"item"},{default:o((()=>[d(t,{class:"text"},{default:o((()=>[p("商品总价: ")])),_:1}),d(t,{class:"number symbol"},{default:o((()=>{var s;return[p(m(null==(s=J.value)?void 0:s.summary.totalPrice.toFixed(2)),1)]})),_:1})])),_:1}),d(l,{class:"item"},{default:o((()=>[d(t,{class:"text"},{default:o((()=>[p("运费: ")])),_:1}),d(t,{class:"number symbol"},{default:o((()=>{var s;return[p(m(null==(s=J.value)?void 0:s.summary.postFee.toFixed(2)),1)]})),_:1})])),_:1})])),_:1})])),_:1}),c(" 吸底工具栏 "),d(l,{class:"toolbar",style:y({paddingBottom:(null==(a=n(V))?void 0:a.bottom)+"px"})},{default:o((()=>{var s;return[d(l,{class:"total-pay symbol"},{default:o((()=>[d(t,{class:"number"},{default:o((()=>{var s;return[p(m(null==(s=J.value)?void 0:s.summary.totalPayPrice.toFixed(2)),1)]})),_:1})])),_:1}),d(l,{class:_(["button",{disabled:!(null==(s=n(L))?void 0:s.id)}]),onClick:N},{default:o((()=>[p(" 提交订单 ")])),_:1},8,["class"])]})),_:1},8,["style"])],64)}}}),[["__scopeId","data-v-cd02674a"]]);export{V as default};
