import{a1 as t,o as e,c as a,w as s,p as l,m as o,t as n,f as u,a as i,k as r,i as c,d,l as f,r as p,a2 as y,a3 as m,q as h,b as _,u as v,F as w,e as g,a4 as b,$ as S,E as k,h as x,B as C,C as D,H as T,s as F,n as I,g as z}from"./index-bf3db433.js";import{_ as O}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as $}from"./uni-popup.191ce7d8.js";import{u as P}from"./index.ec0c0a69.js";import{b as B,c as H,d as M,e as j}from"./order.61ce54ab.js";import{O as N,o as R}from"./contants.7673486a.js";import"./http.d330a529.js";const q={en:{"uni-countdown.day":"day","uni-countdown.h":"h","uni-countdown.m":"m","uni-countdown.s":"s"},"zh-Hans":{"uni-countdown.day":"天","uni-countdown.h":"时","uni-countdown.m":"分","uni-countdown.s":"秒"},"zh-Hant":{"uni-countdown.day":"天","uni-countdown.h":"時","uni-countdown.m":"分","uni-countdown.s":"秒"}},{t:U}=t(q);const J=O({name:"UniCountdown",emits:["timeup"],props:{showDay:{type:Boolean,default:!0},showColon:{type:Boolean,default:!0},start:{type:Boolean,default:!0},backgroundColor:{type:String,default:""},color:{type:String,default:"#333"},fontSize:{type:Number,default:14},splitorColor:{type:String,default:"#333"},day:{type:Number,default:0},hour:{type:Number,default:0},minute:{type:Number,default:0},second:{type:Number,default:0},timestamp:{type:Number,default:0},zeroPad:{type:Boolean,default:!0}},data:()=>({timer:null,syncFlag:!1,d:"00",h:"00",i:"00",s:"00",leftTime:0,seconds:0}),computed:{dayText:()=>U("uni-countdown.day"),hourText:t=>U("uni-countdown.h"),minuteText:t=>U("uni-countdown.m"),secondText:t=>U("uni-countdown.s"),timeStyle(){const{color:t,backgroundColor:e,fontSize:a}=this;return{color:t,backgroundColor:e,fontSize:`${a}px`,width:22*a/14+"px",lineHeight:20*a/14+"px",borderRadius:3*a/14+"px"}},splitorStyle(){const{splitorColor:t,fontSize:e,backgroundColor:a}=this;return{color:t,fontSize:12*e/14+"px",margin:a?4*e/14+"px":""}}},watch:{day(t){this.changeFlag()},hour(t){this.changeFlag()},minute(t){this.changeFlag()},second(t){this.changeFlag()},start:{immediate:!0,handler(t,e){if(t)this.startData();else{if(!e)return;clearInterval(this.timer)}}}},created:function(t){this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.countDown()},unmounted(){clearInterval(this.timer)},methods:{toSeconds:(t,e,a,s,l)=>t?t-parseInt((new Date).getTime()/1e3,10):60*e*60*24+60*a*60+60*s+l,timeUp(){clearInterval(this.timer),this.$emit("timeup")},countDown(){let t=this.seconds,[e,a,s,l]=[0,0,0,0];t>0?(e=Math.floor(t/86400),a=Math.floor(t/3600)-24*e,s=Math.floor(t/60)-24*e*60-60*a,l=Math.floor(t)-24*e*60*60-60*a*60-60*s):this.timeUp(),e=e<10&&this.zeroPad?`0${e}`:e,a=a<10&&this.zeroPad?`0${a}`:a,s=s<10&&this.zeroPad?`0${s}`:s,l=l<10&&this.zeroPad?`0${l}`:l,this.d=e,this.h=a,this.i=s,this.s=l},startData(){if(this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.seconds<=0)return this.seconds=this.toSeconds(0,0,0,0,0),void this.countDown();clearInterval(this.timer),this.countDown(),this.timer=setInterval((()=>{this.seconds--,this.seconds<0?this.timeUp():this.countDown()}),1e3)},update(){this.startData()},changeFlag(){this.syncFlag||(this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.startData(),this.syncFlag=!0)}}},[["render",function(t,d,f,p,y,m){const h=r,_=c;return e(),a(_,{class:"uni-countdown"},{default:s((()=>[f.showDay?(e(),a(h,{key:0,style:l([m.timeStyle]),class:"uni-countdown__number"},{default:s((()=>[o(n(y.d),1)])),_:1},8,["style"])):u("v-if",!0),f.showDay?(e(),a(h,{key:1,style:l([m.splitorStyle]),class:"uni-countdown__splitor"},{default:s((()=>[o(n(m.dayText),1)])),_:1},8,["style"])):u("v-if",!0),i(h,{style:l([m.timeStyle]),class:"uni-countdown__number"},{default:s((()=>[o(n(y.h),1)])),_:1},8,["style"]),i(h,{style:l([m.splitorStyle]),class:"uni-countdown__splitor"},{default:s((()=>[o(n(f.showColon?":":m.hourText),1)])),_:1},8,["style"]),i(h,{style:l([m.timeStyle]),class:"uni-countdown__number"},{default:s((()=>[o(n(y.i),1)])),_:1},8,["style"]),i(h,{style:l([m.splitorStyle]),class:"uni-countdown__splitor"},{default:s((()=>[o(n(f.showColon?":":m.minuteText),1)])),_:1},8,["style"]),i(h,{style:l([m.timeStyle]),class:"uni-countdown__number"},{default:s((()=>[o(n(y.s),1)])),_:1},8,["style"]),f.showColon?u("v-if",!0):(e(),a(h,{key:2,style:l([m.splitorStyle]),class:"uni-countdown__splitor"},{default:s((()=>[o(n(m.secondText),1)])),_:1},8,["style"]))])),_:1})}],["__scopeId","data-v-f9a40030"]]),A=O(d({__name:"detail",props:{id:null},setup(t){const d=t,{safeAreaInsets:O}=f(),{guessRef:q,onScrolltolower:U}=P(),A=p(),K=p(["商品无货","不想要了","商品信息填错了","地址信息填写错误","商品降价","其它"]),X=p(""),Y=y(),E=Y.at(-1);m((()=>{E.animate(".navbar",[{backgroundColor:"transparent"},{backgroundColor:"#f8f8f8"}],1e3,{scrollSource:"#myScroller",timeRange:1e3,startScrollOffset:0,endScrollOffset:50}),E.animate(".navbar .title",[{color:"transparent"},{color:"#000"}],1e3,{scrollSource:"#myScroller",timeRange:1e3,startScrollOffset:0,endScrollOffset:50}),E.animate(".navbar .back",[{color:"#fff"},{color:"#000"}],1e3,{scrollSource:"#myScroller",timeRange:1e3,startScrollOffset:0,endScrollOffset:50})}));const G=p();h((()=>{(async()=>{const t=await B(d.id);G.value=t.result,[N.DaiShouHuo,N.DaiPingJia,N.YiWanCheng].includes(G.value.orderState)&&W()})()}));const Q=p(),W=async()=>{const t=await H(d.id);Q.value=t.result.list},L=()=>{G.value.orderState=N.YiQuXiao},V=async()=>{S({url:`/pagesOrder/payment/payment?id=${d.id}`})},Z=async()=>{},tt=()=>{k({title:"为保障您的权益，请在收到商品后再点击确认",success:async t=>{if(t.confirm){const t=await M(d.id);G.value=t.result}}})},et=()=>{k({title:"是否删除订单",success:async t=>{t.confirm&&(await j({ids:[d.id]}),S({url:"/pagesOrders/list/list"}))}})};return(t,f)=>{var p;const y=x,m=c,h=r,S=C(D("uni-countdown"),J),k=z,P=T("XtxGuess"),B=T("PageSkeleton"),H=F,M=C(D("uni-popup"),$);return e(),_(w,null,[u(" 自定义导航栏: 默认透明不可见, scroll-view 滚动到 50 时展示 "),i(m,{class:"navbar",style:l({paddingTop:(null==(p=v(O))?void 0:p.top)+"px"})},{default:s((()=>[i(m,{class:"wrap"},{default:s((()=>[v(Y).length>1?(e(),a(y,{key:0,"open-type":"navigateBack",class:"back icon-left"})):(e(),a(y,{key:1,url:"/pages/index/index","open-type":"switchTab",class:"back icon-home"})),i(m,{class:"title"},{default:s((()=>[o("订单详情")])),_:1})])),_:1})])),_:1},8,["style"]),i(H,{"scroll-y":"",class:"viewport",id:"myScroller",onScrolltolower:v(U)},{default:s((()=>{var t,r;return[G.value?(e(),_(w,{key:0},[u(" 解决?.问题 "),u(" 订单状态 "),i(m,{class:"overview",style:l({paddingTop:v(O).top+20+"px"})},{default:s((()=>{var t;return[u(" 待付款状态:展示去支付按钮和倒计时 "),(null==(t=G.value)?void 0:t.orderState)===v(N).DaiFuKuan?(e(),_(w,{key:0},[i(m,{class:"status icon-clock"},{default:s((()=>[o("等待付款")])),_:1}),i(m,{class:"tips"},{default:s((()=>[i(h,{class:"money"},{default:s((()=>[o("应付金额: "+n(G.value.payMoney),1)])),_:1}),i(h,{class:"time"},{default:s((()=>[o("支付剩余")])),_:1}),i(S,{second:G.value.countdown,color:"#fff","splitor-color":"#fff","show-day":!1,"show-colon":!1,onTimeup:L},null,8,["second"])])),_:1}),i(m,{class:"button",onClick:V},{default:s((()=>[o("去支付")])),_:1})],64)):(e(),_(w,{key:1},[u(" 其他订单状态:展示再次购买按钮 "),u(" 订单状态文字 "),i(m,{class:"status"},{default:s((()=>[o(n(v(R)[G.value.orderState].text),1)])),_:1}),i(m,{class:"button-group"},{default:s((()=>[i(y,{class:"button",url:`/pagesOrder/create/create?orderId=${d.id}`,"hover-class":"none"},{default:s((()=>[o(" 再次购买 "),u("  ")])),_:1},8,["url"]),u(" 待发货状态：模拟发货,开发期间使用,用于修改订单状态为已发货 "),v(false)&&G.value.orderState===v(N).DaiFaHuo?(e(),a(m,{key:0,onClick:Z,class:"button"},{default:s((()=>[o(" 模拟发货 ")])),_:1})):u("v-if",!0),G.value.orderState===v(N).DaiShouHuo?(e(),a(m,{key:1,onClick:tt,class:"button"},{default:s((()=>[o("确认收货")])),_:1})):u("v-if",!0)])),_:1})],64))]})),_:1},8,["style"]),u(" 配送状态 "),i(m,{class:"shipment"},{default:s((()=>[u(" 订单物流信息 "),(e(!0),_(w,null,g(Q.value,(t=>(e(),a(m,{key:t.id,class:"item"},{default:s((()=>[i(m,{class:"message"},{default:s((()=>[o(n(t.text),1)])),_:2},1024),i(m,{class:"date"},{default:s((()=>[o(n(t.time),1)])),_:2},1024)])),_:2},1024)))),128)),u(" 用户收货地址 "),i(m,{class:"locate"},{default:s((()=>[i(m,{class:"user"},{default:s((()=>[o(n(G.value.receiverContact)+" "+n(G.value.receiverMobile),1)])),_:1}),i(m,{class:"address"},{default:s((()=>[o(n(G.value.receiverAddress),1)])),_:1})])),_:1})])),_:1}),u(" 商品信息 "),i(m,{class:"goods"},{default:s((()=>[i(m,{class:"item"},{default:s((()=>[(e(!0),_(w,null,g(G.value.skus,(t=>(e(),a(y,{class:"navigator",key:t.spuId,url:`/pages/goods/goods?id=${t.spuId}`,"hover-class":"none"},{default:s((()=>[i(k,{class:"cover",src:t.image},null,8,["src"]),i(m,{class:"meta"},{default:s((()=>[i(m,{class:"name ellipsis"},{default:s((()=>[o(n(t.name),1)])),_:2},1024),i(m,{class:"type"},{default:s((()=>[o(n(t.attrsText),1)])),_:2},1024),i(m,{class:"price"},{default:s((()=>[i(m,{class:"actual"},{default:s((()=>[i(h,{class:"symbol"},{default:s((()=>[o("¥")])),_:1}),i(h,null,{default:s((()=>[o(n(t.curPrice),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),i(m,{class:"quantity"},{default:s((()=>[o("x"+n(t.quantity),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128)),u(" 待评价状态:展示按钮 "),(e(),a(m,{key:0,class:"action"},{default:s((()=>[i(m,{class:"button primary"},{default:s((()=>[o("申请售后")])),_:1}),i(y,{url:"",class:"button"},{default:s((()=>[o(" 去评价 ")])),_:1})])),_:1}))])),_:1}),u(" 合计 "),i(m,{class:"total"},{default:s((()=>[i(m,{class:"row"},{default:s((()=>[i(m,{class:"text"},{default:s((()=>[o("商品总价: ")])),_:1}),i(m,{class:"symbol"},{default:s((()=>[o(n(G.value.totalMoney),1)])),_:1})])),_:1}),i(m,{class:"row"},{default:s((()=>[i(m,{class:"text"},{default:s((()=>[o("运费: ")])),_:1}),i(m,{class:"symbol"},{default:s((()=>[o(n(G.value.postFee),1)])),_:1})])),_:1}),i(m,{class:"row"},{default:s((()=>[i(m,{class:"text"},{default:s((()=>[o("应付金额: ")])),_:1}),i(m,{class:"symbol primary"},{default:s((()=>[o(n(G.value.payMoney),1)])),_:1})])),_:1})])),_:1})])),_:1}),u(" 订单信息 "),i(m,{class:"detail"},{default:s((()=>[i(m,{class:"title"},{default:s((()=>[o("订单信息")])),_:1}),i(m,{class:"row"},{default:s((()=>[i(m,{class:"item"},{default:s((()=>[o(" 订单编号: "+n(d.id)+" ",1),i(h,{class:"copy",onClick:f[0]||(f[0]=t=>{return e=d.id,void b({data:e});var e})},{default:s((()=>[o("复制")])),_:1})])),_:1}),i(m,{class:"item"},{default:s((()=>[o("下单时间: "+n(G.value.createTime),1)])),_:1})])),_:1})])),_:1}),u(" 猜你喜欢 "),i(P,{ref_key:"guessRef",ref:q},null,512),u(" 底部操作栏 "),i(m,{class:"toolbar-height",style:l({paddingBottom:(null==(t=v(O))?void 0:t.bottom)+"px"})},null,8,["style"]),i(m,{class:"toolbar",style:l({paddingBottom:(null==(r=v(O))?void 0:r.bottom)+"px"})},{default:s((()=>[u(" 待付款状态:展示支付按钮 "),G.value.orderState===v(N).DaiFuKuan?(e(),_(w,{key:0},[i(m,{class:"button primary"},{default:s((()=>[o(" 去支付 ")])),_:1}),i(m,{class:"button",onClick:f[1]||(f[1]=t=>{var e,a;return null==(a=null==(e=A.value)?void 0:e.open)?void 0:a.call(e)})},{default:s((()=>[o(" 取消订单 ")])),_:1})],64)):(e(),_(w,{key:1},[u(" 其他订单状态:按需展示按钮 "),i(y,{class:"button secondary",url:`/pagesOrder/create/create?orderId=${d.id}`,"hover-class":"none"},{default:s((()=>[o(" 再次购买 ")])),_:1},8,["url"]),u(" 待收货状态: 展示确认收货 "),G.value.orderState===v(N).DaiShouHuo?(e(),a(m,{key:0,class:"button primary",onClick:tt},{default:s((()=>[o(" 确认收货 ")])),_:1})):u("v-if",!0),u(" 待评价状态: 展示去评价 "),G.value.orderState===v(N).DaiPingJia?(e(),a(m,{key:1,class:"button"},{default:s((()=>[o(" 去评价 ")])),_:1})):u("v-if",!0),u(" 待评价/已完成/已取消 状态: 展示删除订单 "),G.value.orderState>=v(N).DaiPingJia?(e(),a(m,{key:2,class:"button delete",onClick:et},{default:s((()=>[o(" 删除订单 ")])),_:1})):u("v-if",!0)],64))])),_:1},8,["style"])],64)):(e(),_(w,{key:1},[u(" 1.未完成？？？ "),u(" 骨架屏组件 "),i(B)],64))]})),_:1},8,["onScrolltolower"]),u(" 取消订单弹窗 "),i(M,{ref_key:"popup",ref:A,type:"bottom","background-color":"#fff"},{default:s((()=>[i(m,{class:"popup-root"},{default:s((()=>[i(m,{class:"title"},{default:s((()=>[o("订单取消")])),_:1}),i(m,{class:"description"},{default:s((()=>[i(m,{class:"tips"},{default:s((()=>[o("请选择取消订单的原因：")])),_:1}),(e(!0),_(w,null,g(K.value,(t=>(e(),a(m,{class:"cell",key:t,onClick:e=>X.value=t},{default:s((()=>[i(h,{class:"text"},{default:s((()=>[o(n(t),1)])),_:2},1024),i(h,{class:I(["icon",{checked:t===X.value}])},null,8,["class"])])),_:2},1032,["onClick"])))),128))])),_:1}),i(m,{class:"footer"},{default:s((()=>[i(m,{class:"button",onClick:f[2]||(f[2]=t=>{var e,a;return null==(a=null==(e=A.value)?void 0:e.close)?void 0:a.call(e)})},{default:s((()=>[o("取消")])),_:1}),i(m,{class:"button primary"},{default:s((()=>[o("确认")])),_:1})])),_:1})])),_:1})])),_:1},512)],64)}}}),[["__scopeId","data-v-651d5d22"]]);export{A as default};
