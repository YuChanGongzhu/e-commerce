import{d as a,v as e,r as s,x as l,y as t,o as c,c as u,w as n,f as o,u as r,b as d,a as i,m as f,F as _,e as p,n as v,t as m,z as g,A as k,k as b,i as x,g as h,h as y,B as w,C,D as j,s as I,E as V}from"./index-bf3db433.js";import{g as T,p as E,d as F,a as P,_ as U}from"./cart.3a67599c.js";import{_ as X,a as z}from"./uni-swipe-action.c05d133c.js";import{X as A}from"./XtxGuess.1d5a111d.js";import{_ as B}from"./_plugin-vue_export-helper.1b428a4d.js";const D=B(a({__name:"CartMain",setup(a){const B=e(),D=s(),G=async()=>{const a=await T();D.value=a.result};l((()=>{B.profile&&G()}));const M=a=>{P(a.index,{count:a.value})},O=t((()=>{var a;return(null==(a=D.value)?void 0:a.length)&&D.value.every((a=>a.selected))})),R=()=>{var a;const e=!O.value;null==(a=D.value)||a.forEach((a=>{a.selected=e})),E({selected:e})},$=t((()=>{var a;return null==(a=D.value)?void 0:a.filter((a=>a.selected))})),q=t((()=>{var a;return null==(a=$.value)?void 0:a.reduce(((a,e)=>a+e.count),0)})),H=t((()=>{var a;return null==(a=$.value)?void 0:a.reduce(((a,e)=>a+e.count*e.nowPrice),0)})),J=()=>{if(0===q.value)return g({title:"未选中商品",icon:"none"});k({url:"/pagesOrder/create/create"})};return(a,e)=>{const s=b,l=x,t=h,g=y,k=w(C("vk-data-input-number-box"),U),T=j,E=w(C("uni-swipe-action-item"),X),$=w(C("uni-swipe-action"),z),K=I;return c(),u(K,{"scroll-y":"",class:"scroll-view"},{default:n((()=>{var a;return[o(" 已登录: 显示购物车 "),r(B).profile?(c(),d(_,{key:0},[o(" 购物车列表 "),(null==(a=D.value)?void 0:a.length)?(c(),u(l,{key:0,class:"cart-list"},{default:n((()=>[o(" 优惠提示 "),i(l,{class:"tips"},{default:n((()=>[i(s,{class:"label"},{default:n((()=>[f("满减")])),_:1}),i(s,{class:"desc"},{default:n((()=>[f("满1件, 即可享受9折优惠")])),_:1})])),_:1}),o(" 滑动操作分区 "),i($,null,{default:n((()=>[o(" 滑动操作项 "),(c(!0),d(_,null,p(D.value,(a=>(c(),u(E,{key:a.skuId,class:"cart-swipe"},{right:n((()=>[i(l,{class:"cart-swipe-right"},{default:n((()=>[i(T,{onClick:e=>(async a=>{V({title:"是否删除",success:async({confirm:e,cancel:s})=>{e&&(await F({ids:[a]}),G())}})})(a.skuId),class:"button delete-button"},{default:n((()=>[f("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),default:n((()=>[i(l,{class:"goods"},{default:n((()=>[o(" 选中状态 "),i(s,{onClick:e=>(a=>{a.selected=!a.selected,P(a.skuId,{selected:a.selected})})(a),class:v(["checkbox",{checked:a.selected}])},null,8,["onClick","class"]),i(g,{url:`/pages/goods/goods?id=${a.id}`,"hover-class":"none",class:"navigator"},{default:n((()=>[i(t,{mode:"aspectFill",class:"picture",src:a.picture},null,8,["src"]),i(l,{class:"meta"},{default:n((()=>[i(l,{class:"name ellipsis"},{default:n((()=>[f(m(a.name),1)])),_:2},1024),i(l,{class:"attrsText ellipsis"},{default:n((()=>[f(m(a.attrsText),1)])),_:2},1024),i(l,{class:"price"},{default:n((()=>[f(m(a.nowPrice),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"]),o(" 商品数量 "),i(l,{class:"count"},{default:n((()=>[i(k,{modelValue:a.count,"onUpdate:modelValue":e=>a.count=e,min:1,max:a.stock,onChange:M,index:a.skuId},null,8,["modelValue","onUpdate:modelValue","max","index"])])),_:2},1024),f("> ")])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})):(c(),d(_,{key:1},[o(" 购物车空状态 "),i(l,{class:"cart-blank"},{default:n((()=>[i(t,{src:"./static/images/blank_cart.png",class:"image"}),i(s,{class:"text"},{default:n((()=>[f("购物车还是空的，快来挑选好货吧")])),_:1}),i(g,{"open-type":"switchTab",url:"/pages/index/index","hover-class":"none"},{default:n((()=>[i(T,{class:"button"},{default:n((()=>[f("去首页看看")])),_:1})])),_:1})])),_:1})],2112)),o(" 吸底工具栏 "),i(l,{class:"toolbar"},{default:n((()=>[i(s,{onClick:R,class:v(["all",{checked:r(O)}])},{default:n((()=>[f("全选")])),_:1},8,["class"]),i(s,{class:"text"},{default:n((()=>[f("合计:")])),_:1}),i(s,{class:"amount"},{default:n((()=>[f(m(r(H)),1)])),_:1}),i(l,{class:"button-grounp"},{default:n((()=>[i(l,{class:v(["button payment-button",{disabled:0===r(q)}]),onClick:J},{default:n((()=>[f(" 去结算("+m(r(q))+" ) ",1)])),_:1},8,["class"])])),_:1})])),_:1})],64)):(c(),d(_,{key:1},[o(" 未登录: 提示登录 "),i(l,{class:"login-blank"},{default:n((()=>[i(s,{class:"text"},{default:n((()=>[f("登录后可查看购物车中的商品")])),_:1}),i(g,{url:"/pages/login/login","hover-class":"none"},{default:n((()=>[i(T,{class:"button"},{default:n((()=>[f("去登录")])),_:1})])),_:1})])),_:1})],2112)),o(" 猜你喜欢 "),i(A,{ref:"guessRef"},null,512),o(" 底部占位空盒子 "),i(l,{class:"toolbar-height"})]})),_:1})}}}),[["__scopeId","data-v-7ca8b166"]]);export{D as C};
